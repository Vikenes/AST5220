\subsection{Implementation details}\label{ssec:M3:implementations} 

\subsubsection{Tight coupling regime} \label{sssec:M3:implementations:tight_coupling_regime}
The tight coupling regime is computed with 
\begin{subequations} \label{eq:M3:implementations:TC_ODEs}
    \begin{align}
        \varrho q =& -[(1-R)\tau' + (1+R)\tau''](3\Theta_1 + \vb) \nonumber \\
            & -\koverhp\Psi + (1-\frac{\H'}{\H})\koverhp(-\Theta_0 + 2\Theta_2) - \koverhp\Theta_0', \label{eq:M3:implementations:TC_ODEs_q} \\
        \vb' =& \frac{1}{1+R}\bclosed{-\vb-\koverhp\Psi + R(q+\koverhp[-\Theta_0+2\Theta_2-\Psi])}, \label{eq:M3:implementations:TC_ODEs_v_b} \\
        \Theta_1' =& \frac{1}{3}(q-\vb'), \label{eq:M3:implementations:TC_ODEs_Theta_1} 
    \end{align}
\end{subequations}
where we introduced the parameter 
\begin{equation} \label{eq:M3:implementations:q_prefactor}
    \varrho = (1+R)\tau' + \frac{\H'}{\H} - 1.
\end{equation}


\subsubsection{Initial conditions} \label{sssec:M3:implementations:initial_conditions}
The initial conditions are 
\begin{subequations} \label{eq:M3:implementations:pert_ODE_IC}
    \begin{align}
        \Psi &= -\frac{2}{3}, \label{eq:M3:implementations:pert_ODE_IC_Psi} \\
        \Phi &= - \Psi, \label{eq:M3:implementations:pert_ODE_IC_Phi} \\
        \dcdm &= \db = -\frac{3}{2}\Psi, \label{eq:M3:implementations:pert_ODE_IC_delta_cdm} \\
        \vcdm &= \vb = -\frac{k}{2\H} \Psi, \label{eq:M3:implementations:pert_ODE_IC_v_cdm} \\
        \Theta_0 &= -\frac{1}{2}\Psi, \label{eq:M3:implementations:pert_ODE_IC_Theta0} \\
        \Theta_1 &= \frac{k}{6\H}\Psi, \label{eq:M3:implementations:pert_ODE_IC_Theta1} \\
        \Theta_2 &= - \frac{20k}{45\H\tau'}\Theta_1, \label{eq:M3:implementations:pert_ODE_IC_Theta2} \\
        \Theta_\ell &= - \frac{\ell}{2\ell+1} \frac{k}{\H\tau'}\Theta_{\ell-1} \pnote{Needed?}. \label{eq:M3:implementations:pert_ODE_IC_Theta_ell} 
    \end{align}
\end{subequations}

